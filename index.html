<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ğŸ® Ø®Ø±ÛŒØ¯ Ø³ÛŒâ€ŒÙ¾ÛŒ | ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ù†Ø¸Ø§Ù…ÛŒ Ø¹Ù…Ø§Ø¯</title>
<style>
    @import url('https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/font-face.css');

    :root {
        --primary-color: #2196F3;
        --secondary-color: #4CAF50;
        --danger-color: #dc3545;
        --warning-color: #FFC107;
        --dark-bg: #0a0a2a;
        --card-bg: rgba(0,0,0,0.8);
    }

    body {
        font-family: 'Vazir', sans-serif;
        direction: rtl;
        margin: 0;
        padding: 0;
        background: linear-gradient(135deg, var(--dark-bg) 0%, #1a1a4a 100%);
        color: #fff;
        min-height: 100vh;
    }

    /* Ù‡Ø¯Ø± Ø¨Ø§ Ù…Ù†ÙˆÛŒ Ú©Ø§Ø±Ø¨Ø± */
    .header {
        text-align: center;
        padding: 15px 20px;
        background: rgba(0, 0, 0, 0.8);
        border-bottom: 3px solid var(--primary-color);
        position: relative;
    }

    .user-menu {
        position: absolute;
        left: 20px;
        top: 50%;
        transform: translateY(-50%);
        display: flex;
        gap: 10px;
        align-items: center;
    }

    .user-btn {
        background: rgba(255,255,255,0.1);
        color: white;
        padding: 8px 15px;
        border-radius: 20px;
        border: 1px solid var(--primary-color);
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s;
    }

    .user-btn:hover {
        background: var(--primary-color);
    }

    .admin-btn {
        background: var(--danger-color) !important;
        border-color: var(--danger-color) !important;
    }

    .admin-btn:hover {
        background: #c82333 !important;
    }

    .user-info {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .welcome-text {
        color: var(--warning-color);
        font-size: 14px;
    }

    .game-count {
        background: var(--secondary-color);
        color: white;
        padding: 2px 8px;
        border-radius: 10px;
        font-size: 12px;
    }

    .header h1 {
        color: var(--primary-color);
        margin: 0;
        font-size: 28px;
        text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }

    .header p {
        color: #aaa;
        margin: 10px 0 0;
    }

    /* Ù…ÙˆØ¯Ø§Ù„â€ŒÙ‡Ø§ */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.9);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 10000;
    }

    .modal {
        background: var(--card-bg);
        border: 3px solid var(--primary-color);
        border-radius: 15px;
        padding: 30px;
        width: 90%;
        max-width: 450px;
        text-align: center;
    }

    .modal h3 {
        color: var(--primary-color);
        margin-top: 0;
    }

    .modal-input {
        width: 100%;
        padding: 12px;
        margin: 10px 0;
        border-radius: 8px;
        border: 1px solid #555;
        background: rgba(255,255,255,0.1);
        color: white;
        font-size: 16px;
        text-align: center;
    }

    .modal-error {
        color: var(--danger-color);
        font-size: 14px;
        margin: 10px 0;
        display: none;
    }

    /* Ø¨Ø§Ø²ÛŒ Ù¾ÛŒÚ†ÛŒØ¯Ù‡ */
    .game-container {
        background: var(--card-bg);
        border: 3px solid var(--secondary-color);
        border-radius: 20px;
        padding: 25px;
        margin: 25px auto;
        max-width: 1000px;
        display: none;
    }

    .game-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
        gap: 15px;
    }

    .game-stats {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
        margin-bottom: 20px;
    }

    @media (max-width: 768px) {
        .game-stats {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    .stat-box {
        background: rgba(255,255,255,0.1);
        padding: 15px;
        border-radius: 10px;
        text-align: center;
    }

    .stat-value {
        font-size: 28px;
        font-weight: bold;
        color: var(--warning-color);
        margin: 5px 0;
    }

    .stat-label {
        color: #aaa;
        font-size: 14px;
    }

    /* Ø§Ù†ÙˆØ§Ø¹ Ù…Ø®ØªÙ„Ù Ù‡Ø¯Ùâ€ŒÙ‡Ø§ */
    .target {
        position: absolute;
        cursor: pointer;
        user-select: none;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: white;
    }

    .target-normal {
        width: 60px;
        height: 60px;
        background: #FF5722;
        border-radius: 50%;
        animation: pulse 1s infinite;
    }

    .target-bonus {
        width: 40px;
        height: 40px;
        background: #FFC107;
        border-radius: 10px;
        animation: rotate 2s infinite linear;
    }

    .target-bomb {
        width: 70px;
        height: 70px;
        background: #dc3545;
        border-radius: 50%;
        animation: shake 0.5s infinite;
    }

    .target-time {
        width: 50px;
        height: 50px;
        background: #2196F3;
        border-radius: 50%;
        animation: bounce 1s infinite;
    }

    @keyframes pulse {
        0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 87, 34, 0.7); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); box-shadow: 0 0 0 10px rgba(255, 87, 34, 0); }
    }

    @keyframes rotate {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        75% { transform: translateX(5px); }
    }

    @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }

    .game-area {
        position: relative;
        width: 100%;
        height: 400px;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 10px;
        margin: 20px 0;
        border: 2px solid #333;
        overflow: hidden;
    }

    .power-ups {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin: 15px 0;
        flex-wrap: wrap;
    }

    .power-btn {
        background: rgba(255,255,255,0.1);
        color: white;
        padding: 8px 15px;
        border-radius: 20px;
        border: 1px solid var(--warning-color);
        cursor: pointer;
        transition: all 0.3s;
    }

    .power-btn:hover:not(:disabled) {
        background: var(--warning-color);
        color: #000;
    }

    .power-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    /* Ù…Ø­ØµÙˆÙ„Ø§Øª */
    .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 30px 0;
    }

    .product-card {
        background: var(--card-bg);
        border-radius: 15px;
        padding: 20px;
        text-align: center;
        border: 2px solid var(--primary-color);
        transition: all 0.3s;
        position: relative;
    }

    .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(33, 150, 243, 0.4);
    }

    .product-card img {
        width: 80px;
        height: 80px;
        object-fit: contain;
        margin-bottom: 15px;
        border-radius: 50%;
        border: 3px solid var(--primary-color);
        background: rgba(255,255,255,0.1);
        padding: 5px;
    }

    .product-price {
        font-size: 24px;
        font-weight: bold;
        color: var(--secondary-color);
        margin: 15px 0;
    }

    .edit-price-btn {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(255,255,255,0.2);
        color: white;
        border: none;
        border-radius: 5px;
        padding: 5px 10px;
        cursor: pointer;
        font-size: 12px;
        display: none;
    }

    .admin-controls {
        text-align: center;
        margin: 20px 0;
        padding: 20px;
        background: rgba(0,0,0,0.5);
        border-radius: 10px;
        display: none;
    }

    /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ */
    .btn {
        display: inline-block;
        background: linear-gradient(135deg, var(--primary-color), #1976D2);
        color: white;
        padding: 12px 25px;
        border-radius: 25px;
        text-decoration: none;
        border: none;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s;
        margin: 5px;
    }

    .btn:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }

    .btn-success {
        background: linear-gradient(135deg, var(--secondary-color), #2E7D32);
    }

    .btn-danger {
        background: linear-gradient(135deg, var(--danger-color), #c82333);
    }

    .btn-warning {
        background: linear-gradient(135deg, var(--warning-color), #e0a800);
        color: #000;
    }

    /* ÙÙˆØªØªØ± */
    .footer {
        text-align: center;
        padding: 20px;
        background: rgba(0,0,0,0.8);
        margin-top: 40px;
        border-top: 2px solid var(--primary-color);
    }

    /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ */
    @keyframes slideIn {
        from {
            transform: translateX(-50%) translateY(-100%);
            opacity: 0;
        }
        to {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
    }

    @keyframes slideOut {
        from {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        to {
            transform: translateX(-50%) translateY(-100%);
            opacity: 0;
        }
    }
</style>
</head>
<body>

<div class="header">
    <div class="user-menu">
        <div id="userButtons">
            <button class="user-btn" onclick="showLoginModal()">ğŸ” ÙˆØ±ÙˆØ¯</button>
            <button class="user-btn" onclick="showRegisterModal()">ğŸ“ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</button>
            <button class="user-btn admin-btn" onclick="showAdminLoginModal()">ğŸ‘‘ ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ†</button>
        </div>
        <div id="userInfo" style="display: none;">
            <div class="user-info">
                <span class="welcome-text" id="welcomeText"></span>
                <span class="game-count" id="gameCount">Û³/Û³</span>
                <button class="user-btn" onclick="logoutUser()">Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>
    </div>
    
    <h1>ğŸ® Ø®Ø±ÛŒØ¯ Ø³ÛŒâ€ŒÙ¾ÛŒ | ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ù†Ø¸Ø§Ù…ÛŒ Ø¹Ù…Ø§Ø¯</h1>
    <p>Ø®Ø±ÛŒØ¯ Ø§Ù…Ù† Ùˆ Ø³Ø±ÛŒØ¹ Ø³ÛŒâ€ŒÙ¾ÛŒ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø­Ø¨ÙˆØ¨</p>
</div>

<div class="container" id="mainContainer">
    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ Ø§ÛŒÙ†Ø¬Ø§ Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø± -->
<div class="modal-overlay" id="loginModal">
    <div class="modal">
        <h3>ğŸ” ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ</h3>
        <input type="text" id="loginUsername" class="modal-input" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ">
        <input type="password" id="loginPassword" class="modal-input" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±">
        <div class="modal-error" id="loginError"></div>
        <button class="btn" onclick="loginUser()">ÙˆØ±ÙˆØ¯</button>
        <button class="btn btn-danger" onclick="hideModal('loginModal')">Ø§Ù†ØµØ±Ø§Ù</button>
    </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± -->
<div class="modal-overlay" id="registerModal">
    <div class="modal">
        <h3>ğŸ“ Ø§ÛŒØ¬Ø§Ø¯ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÛŒØ¯</h3>
        <input type="text" id="regUsername" class="modal-input" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ (Ø­Ø¯Ø§Ù‚Ù„ Û´ Ø­Ø±Ù)">
        <input type="password" id="regPassword" class="modal-input" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± (Ø­Ø¯Ø§Ù‚Ù„ Û¶ Ø­Ø±Ù)">
        <input type="password" id="regConfirm" class="modal-input" placeholder="ØªÚ©Ø±Ø§Ø± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±">
        <input type="text" id="regPhone" class="modal-input" placeholder="Ø´Ù…Ø§Ø±Ù‡ Ù‡Ù…Ø±Ø§Ù‡ (Û°Û¹Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹)">
        <div class="modal-error" id="registerError"></div>
        <button class="btn btn-success" onclick="registerUser()">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</button>
        <button class="btn btn-danger" onclick="hideModal('registerModal')">Ø§Ù†ØµØ±Ø§Ù</button>
    </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ† -->
<div class="modal-overlay" id="adminLoginModal">
    <div class="modal">
        <h3>ğŸ‘‘ ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ†</h3>
        <p style="color: #aaa; margin-bottom: 15px;">ÙÙ‚Ø· Ù…Ø¯ÛŒØ±Ø§Ù† Ø³ÛŒØ³ØªÙ…</p>
        <input type="text" id="adminUser" class="modal-input" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø§Ø¯Ù…ÛŒÙ†">
        <input type="password" id="adminPass" class="modal-input" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø¯Ù…ÛŒÙ†">
        <div class="modal-error" id="adminError"></div>
        <button class="btn btn-warning" onclick="loginAdmin()">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</button>
        <button class="btn btn-danger" onclick="hideModal('adminLoginModal')">Ø§Ù†ØµØ±Ø§Ù</button>
    </div>
</div>

<div class="footer">
    <p>Â© Û±Û´Û°Û³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ù†Ø¸Ø§Ù…ÛŒ Ø¹Ù…Ø§Ø¯ | Ø®Ø±ÛŒØ¯ Ø§Ù…Ù† Ø³ÛŒâ€ŒÙ¾ÛŒ</p>
    <a href="javascript:history.back()" class="btn">â† Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø§ØµÙ„ÛŒ</a>
</div>

<script>
// ==================== Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª ====================
const ADMIN_CREDENTIALS = {
    username: "admin_military",
    password: "Em@d313M!2024#Secure"
};

// ==================== Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø¬Ù‡Ø§Ù†ÛŒ ====================
let currentUser = null;
let isAdminLoggedIn = false;
let products = [
    {id: 1, name: "Ø³ÛŒâ€ŒÙ¾ÛŒ Ø¯ÙˆØ¨Ù„", price: 50000, img: "https://rengogame.com/wp-content/uploads/2023/09/cp2x-codm-rengogame.jpg"},
    {id: 2, name: "Ø¢ÙØ± ÙˆÛŒÚ˜Ù‡", price: 75000, img: "https://rengogame.com/wp-content/uploads/2025/08/battlepass-call-of-duty-mobile-2025.webp"},
    {id: 3, name: "Ø¨Ø³ØªÙ‡ Ø·Ù„Ø§ÛŒÛŒ", price: 120000, img: "https://rengogame.com/wp-content/uploads/2025/08/cp-fori-call-of-duty-mobile-2025.webp"},
    {id: 4, name: "Ø¨Ø³ØªÙ‡ Ù†Ù‚Ø±Ù‡â€ŒØ§ÛŒ", price: 80000, img: "https://rengogame.com/wp-content/uploads/2025/08/cp-fori-call-of-duty-mobile-2025.webp"},
    {id: 5, name: "Ø¨Ø³ØªÙ‡ Ø¨Ø±Ù†Ø²ÛŒ", price: 40000, img: "https://rengogame.com/wp-content/uploads/2025/08/cp-fori-call-of-duty-mobile-2025.webp"}
];

// ==================== Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒ ====================
let gameActive = false;
let gameScore = 0;
let gameTime = 60;
let gameLevel = 1;
let remainingGames = 3;
let powerUps = {
    doublePoints: 1,
    timeFreeze: 1,
    bombDefuser: 1
};
let gameTimer;
let targetTimers = [];
let activeTargets = [];

// ==================== ØªÙˆØ§Ø¨Ø¹ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ====================
function showLoginModal() {
    showModal('loginModal');
}

function showRegisterModal() {
    showModal('registerModal');
}

function showAdminLoginModal() {
    showModal('adminLoginModal');
}

function showModal(modalId) {
    document.getElementById(modalId).style.display = 'flex';
}

function hideModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
    document.getElementById(modalId.replace('Modal', 'Error')).textContent = '';
}

function loginUser() {
    const username = document.getElementById('loginUsername').value.trim();
    const password = document.getElementById('loginPassword').value.trim();
    
    if (!username || !password) {
        showError('loginError', 'Ù„Ø·ÙØ§Ù‹ Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯');
        return;
    }
    
    const users = JSON.parse(localStorage.getItem('cp_users') || '[]');
    const user = users.find(u => u.username === username && u.password === password);
    
    if (user) {
        currentUser = {
            ...user,
            lastGameDate: new Date().toLocaleDateString('fa-IR'),
            gamesPlayedToday: user.gamesPlayedToday || 0
        };
        
        // Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡
        if (user.lastGameDate !== currentUser.lastGameDate) {
            currentUser.gamesPlayedToday = 0;
        }
        
        remainingGames = 3 - currentUser.gamesPlayedToday;
        
        updateUserUI();
        hideModal('loginModal');
        loadMainContent();
        showMessage('âœ… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÙˆØ§Ø±Ø¯ Ø´Ø¯ÛŒØ¯', 'success');
    } else {
        showError('loginError', 'Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª');
    }
}

function registerUser() {
    const username = document.getElementById('regUsername').value.trim();
    const password = document.getElementById('regPassword').value.trim();
    const confirm = document.getElementById('regConfirm').value.trim();
    const phone = document.getElementById('regPhone').value.trim();
    
    // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
    if (!username || username.length < 4) {
        showError('registerError', 'Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û´ Ø­Ø±Ù Ø¨Ø§Ø´Ø¯');
        return;
    }
    
    if (!password || password.length < 6) {
        showError('registerError', 'Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û¶ Ø­Ø±Ù Ø¨Ø§Ø´Ø¯');
        return;
    }
    
    if (password !== confirm) {
        showError('registerError', 'Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ùˆ ØªÚ©Ø±Ø§Ø± Ø¢Ù† Ù…Ø·Ø§Ø¨Ù‚Øª Ù†Ø¯Ø§Ø±Ù†Ø¯');
        return;
    }
    
    if (!phone || !/^09[0-9]{9}$/.test(phone)) {
        showError('registerError', 'Ø´Ù…Ø§Ø±Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
        return;
    }
    
    const users = JSON.parse(localStorage.getItem('cp_users') || '[]');
    
    // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø±
    if (users.some(u => u.username === username)) {
        showError('registerError', 'Ø§ÛŒÙ† Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù‚Ø¨Ù„Ø§Ù‹ Ø«Ø¨Øª Ø´Ø¯Ù‡ Ø§Ø³Øª');
        return;
    }
    
    // Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯
    const newUser = {
        id: Date.now(),
        username: username,
        password: password,
        phone: phone,
        registerDate: new Date().toLocaleDateString('fa-IR'),
        totalGames: 0,
        totalScore: 0,
        gamesPlayedToday: 0,
        lastGameDate: null,
        isAdmin: false
    };
    
    users.push(newUser);
    localStorage.setItem('cp_users', JSON.stringify(users));
    
    currentUser = newUser;
    remainingGames = 3;
    
    updateUserUI();
    hideModal('registerModal');
    loadMainContent();
    showMessage('ğŸ‰ Ø­Ø³Ø§Ø¨ Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯!', 'success');
}

function logoutUser() {
    if (currentUser) {
        // Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±
        const users = JSON.parse(localStorage.getItem('cp_users') || '[]');
        const userIndex = users.findIndex(u => u.id === currentUser.id);
        if (userIndex !== -1) {
            users[userIndex] = {...currentUser};
            localStorage.setItem('cp_users', JSON.stringify(users));
        }
    }
    
    currentUser = null;
    isAdminLoggedIn = false;
    updateUserUI();
    loadMainContent();
    showMessage('ğŸ‘‹ Ø§Ø² Ø­Ø³Ø§Ø¨ Ø®ÙˆØ¯ Ø®Ø§Ø±Ø¬ Ø´Ø¯ÛŒØ¯', 'info');
}

function updateUserUI() {
    const userButtons = document.getElementById('userButtons');
    const userInfo = document.getElementById('userInfo');
    
    if (currentUser) {
        userButtons.style.display = 'none';
        userInfo.style.display = 'block';
        document.getElementById('welcomeText').textContent = `ğŸ‘‹ ${currentUser.username}`;
        document.getElementById('gameCount').textContent = `${remainingGames}/Û³`;
    } else {
        userButtons.style.display = 'flex';
        userInfo.style.display = 'none';
    }
    
    // Ù†Ù…Ø§ÛŒØ´/Ù¾Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù† Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ø§Ø¯Ù…ÛŒÙ†
    const adminControls = document.querySelector('.admin-controls');
    if (isAdminLoggedIn) {
        if (adminControls) adminControls.style.display = 'block';
        document.querySelectorAll('.edit-price-btn').forEach(btn => btn.style.display = 'block');
    } else {
        if (adminControls) adminControls.style.display = 'none';
        document.querySelectorAll('.edit-price-btn').forEach(btn => btn.style.display = 'none');
    }
}

// ==================== ØªÙˆØ§Ø¨Ø¹ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¯Ù…ÛŒÙ† ====================
function loginAdmin() {
    const username = document.getElementById('adminUser').value.trim();
    const password = document.getElementById('adminPass').value.trim();
    
    if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
        isAdminLoggedIn = true;
        hideModal('adminLoginModal');
        updateUserUI();
        loadMainContent();
        showMessage('âœ… ÙˆØ§Ø±Ø¯ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø´Ø¯ÛŒØ¯', 'success');
    } else {
        showError('adminError', 'Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆØ±ÙˆØ¯ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª');
    }
}

function editProductPrice(productId) {
    if (!isAdminLoggedIn) {
        showMessage('âŒ ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ†â€ŒÙ‡Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ù‚ÛŒÙ…Øª Ø±Ø§ ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ù†Ù†Ø¯', 'error');
        return;
    }
    
    const product = products.find(p => p.id === productId);
    if (!product) return;
    
    const newPrice = prompt(`ÙˆÛŒØ±Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª ${product.name}:\nÙ‚ÛŒÙ…Øª ÙØ¹Ù„ÛŒ: ${product.price.toLocaleString()} ØªÙˆÙ…Ø§Ù†`, product.price);
    
    if (newPrice && !isNaN(newPrice) && newPrice > 0) {
        product.price = parseInt(newPrice);
        saveProducts();
        loadMainContent();
        showMessage('âœ… Ù‚ÛŒÙ…Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÙˆÛŒØ±Ø§ÛŒØ´ Ø´Ø¯', 'success');
    }
}

function addNewProduct() {
    if (!isAdminLoggedIn) {
        showMessage('âŒ ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ†â€ŒÙ‡Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ù…Ø­ØµÙˆÙ„ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†Ù†Ø¯', 'error');
        return;
    }
    
    const name = prompt('Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯:');
    if (!name) return;
    
    const price = prompt('Ù‚ÛŒÙ…Øª Ù…Ø­ØµÙˆÙ„ (ØªÙˆÙ…Ø§Ù†):');
    if (!price || isNaN(price) || price <= 0) return;
    
    const newProduct = {
        id: products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1,
        name: name,
        price: parseInt(price),
        img: "https://rengogame.com/wp-content/uploads/2025/08/cp-fori-call-of-duty-mobile-2025.webp"
    };
    
    products.push(newProduct);
    saveProducts();
    loadMainContent();
    showMessage('âœ… Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯', 'success');
}

function saveProducts() {
    localStorage.setItem('cp_products', JSON.stringify(products));
}

function loadProducts() {
    const saved = localStorage.getItem('cp_products');
    if (saved) {
        products = JSON.parse(saved);
    }
}

// ==================== ØªÙˆØ§Ø¨Ø¹ Ø¨Ø§Ø²ÛŒ Ù¾ÛŒÚ†ÛŒØ¯Ù‡ ====================
function showGame() {
    if (!currentUser) {
        showMessage('âŒ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²ÛŒ Ø¨Ø§ÛŒØ¯ Ø§Ø¨ØªØ¯Ø§ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯', 'error');
        showLoginModal();
        return;
    }
    
    if (remainingGames <= 0) {
        showMessage('âŒ Ø§Ù…Ø±ÙˆØ² Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§ Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯Ù‡ Ø§Ø³Øª. ÙØ±Ø¯Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯!', 'error');
        return;
    }
    
    document.getElementById('mainContainer').innerHTML = `
        <div class="game-container" id="gameContainer">
            <div class="game-header">
                <h2 style="color: var(--secondary-color); margin: 0;">ğŸ® Ø¨Ø§Ø²ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª 80 Ø³ÛŒâ€ŒÙ¾ÛŒ Ø±Ø§ÛŒÚ¯Ø§Ù†</h2>
                <div style="display: flex; gap: 10px;">
                    <button class="btn" onclick="loadMainContent()">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
                    <button class="btn btn-danger" onclick="endGame()" id="endGameBtn">Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ</button>
                </div>
            </div>
            
            <div class="game-stats">
                <div class="stat-box">
                    <div class="stat-value" id="scoreDisplay">Û°</div>
                    <div class="stat-label">Ø§Ù…ØªÛŒØ§Ø²</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="timeDisplay">Û¶Û°</div>
                    <div class="stat-label">Ø«Ø§Ù†ÛŒÙ‡</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="levelDisplay">Û±</div>
                    <div class="stat-label">Ù…Ø±Ø­Ù„Ù‡</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value">${remainingGames}/Û³</div>
                    <div class="stat-label">Ø¨Ø§Ø²ÛŒ Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡</div>
                </div>
            </div>
            
            <div class="power-ups">
                <button class="power-btn" onclick="usePowerUp('doublePoints')" id="doubleBtn">
                    âœ¨ Ø§Ù…ØªÛŒØ§Ø² Ø¯ÙˆØ¨Ø±Ø§Ø¨Ø± (${powerUps.doublePoints})
                </button>
                <button class="power-btn" onclick="usePowerUp('timeFreeze')" id="freezeBtn">
                    â¸ï¸ ØªÙˆÙ‚Ù Ø²Ù…Ø§Ù† (${powerUps.timeFreeze})
                </button>
                <button class="power-btn" onclick="usePowerUp('bombDefuser')" id="bombBtn">
                    ğŸ’£ Ø®Ù†Ø«ÛŒâ€ŒÚ©Ù†Ù†Ø¯Ù‡ Ø¨Ù…Ø¨ (${powerUps.bombDefuser})
                </button>
            </div>
            
            <div class="game-area" id="gameArea"></div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-success" onclick="startGame()" id="startBtn">â–¶ï¸ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>
                <button class="btn btn-warning" onclick="resetGame()" id="resetBtn">ğŸ”„ Ø±ÛŒØ³Øª</button>
            </div>
            
            <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin-top: 20px;">
                <h4 style="color: var(--warning-color); margin-top: 0;">ğŸ¯ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¨Ø§Ø²ÛŒ:</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; text-align: right;">
                    <div>ğŸ”´ <strong>Ù‡Ø¯Ù Ù‚Ø±Ù…Ø²:</strong> Û±Û° Ø§Ù…ØªÛŒØ§Ø²</div>
                    <div>ğŸŸ¡ <strong>Ù‡Ø¯Ù Ø²Ø±Ø¯:</strong> Û²Û° Ø§Ù…ØªÛŒØ§Ø² + Ú†Ø±Ø®Ø´</div>
                    <div>ğŸ’£ <strong>Ø¨Ù…Ø¨ Ù‚Ø±Ù…Ø²:</strong> Ù…Ù†ÙÛŒ ÛµÛ° Ø§Ù…ØªÛŒØ§Ø²</div>
                    <div>ğŸ”µ <strong>Ù‡Ø¯Ù Ø¢Ø¨ÛŒ:</strong> +Ûµ Ø«Ø§Ù†ÛŒÙ‡ Ø²Ù…Ø§Ù†</div>
                </div>
                <p style="margin: 10px 0 0; color: #aaa;">Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯Ù† Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Û²Û°Û°Û° Ø§Ù…ØªÛŒØ§Ø² Ø¨Ø±Ø³ÛŒØ¯!</p>
            </div>
        </div>
    `;
    
    document.getElementById('gameContainer').style.display = 'block';
    resetGame();
}

function startGame() {
    if (gameActive) return;
    
    if (remainingGames <= 0) {
        showMessage('âŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ù…Ø±ÙˆØ² Ø´Ù…Ø§ ØªÙ…Ø§Ù… Ø´Ø¯Ù‡ Ø§Ø³Øª', 'error');
        return;
    }
    
    gameActive = true;
    gameScore = 0;
    gameTime = 60;
    gameLevel = 1;
    
    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´
    updateGameDisplay();
    
    // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ø´Ø±ÙˆØ¹
    document.getElementById('startBtn').disabled = true;
    
    // Ø´Ø±ÙˆØ¹ ØªØ§ÛŒÙ…Ø±
    gameTimer = setInterval(() => {
        gameTime--;
        updateGameDisplay();
        
        if (gameTime <= 0) {
            endGame();
        }
        
        // Ø§ÙØ²Ø§ÛŒØ´ Ø³Ø·Ø­ Ø¯Ø± Ø²Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ
        if (gameTime === 45) gameLevel = 2;
        if (gameTime === 30) gameLevel = 3;
        if (gameTime === 15) gameLevel = 4;
    }, 1000);
    
    // Ø§ÛŒØ¬Ø§Ø¯ Ù‡Ø¯Ùâ€ŒÙ‡Ø§
    createTargets();
}

function createTargets() {
    if (!gameActive) return;
    
    const gameArea = document.getElementById('gameArea');
    const types = ['normal', 'bonus', 'bomb', 'time'];
    const probabilities = [0.5, 0.2, 0.15, 0.15]; // Ø§Ø­ØªÙ…Ø§Ù„ Ù‡Ø± Ù†ÙˆØ¹
    
    targetTimers.push(setInterval(() => {
        if (!gameActive) return;
        
        // ØªØ¹Ø¯Ø§Ø¯ Ù‡Ø¯Ùâ€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø·Ø­
        const targetCount = gameLevel + 1;
        
        for (let i = 0; i < targetCount; i++) {
            createSingleTarget(gameArea, types, probabilities);
        }
    }, 1500 - (gameLevel * 200))); // Ø³Ø±Ø¹Øª Ø¨Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ø³Ø·Ø­ Ø¨ÛŒØ´ØªØ± Ù…ÛŒâ€ŒØ´ÙˆØ¯
}

function createSingleTarget(gameArea, types, probabilities) {
    const target = document.createElement('div');
    const rand = Math.random();
    let type = 'normal';
    
    // Ø§Ù†ØªØ®Ø§Ø¨ Ù†ÙˆØ¹ Ù‡Ø¯Ù Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ø­ØªÙ…Ø§Ù„
    let cumulative = 0;
    for (let i = 0; i < types.length; i++) {
        cumulative += probabilities[i];
        if (rand <= cumulative) {
            type = types[i];
            break;
        }
    }
    
    target.className = `target target-${type}`;
    
    // ØªÙ†Ø¸ÛŒÙ… Ù…ØªÙ† Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹
    switch(type) {
        case 'normal': target.textContent = 'ğŸ”´'; break;
        case 'bonus': target.textContent = 'ğŸŸ¡'; break;
        case 'bomb': target.textContent = 'ğŸ’£'; break;
        case 'time': target.textContent = 'â±ï¸'; break;
    }
    
    // Ù…ÙˆÙ‚Ø¹ÛŒØª ØªØµØ§Ø¯ÙÛŒ
    const maxX = gameArea.offsetWidth - 80;
    const maxY = gameArea.offsetHeight - 80;
    const x = Math.floor(Math.random() * maxX);
    const y = Math.floor(Math.random() * maxY);
    
    target.style.left = x + 'px';
    target.style.top = y + 'px';
    
    // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ú©Ù„ÛŒÚ©
    target.onclick = function() {
        if (!gameActive) return;
        
        let scoreChange = 0;
        let timeChange = 0;
        
        switch(type) {
            case 'normal':
                scoreChange = 10 * gameLevel;
                this.style.background = '#4CAF50';
                this.textContent = 'âœ…';
                break;
            case 'bonus':
                scoreChange = 20 * gameLevel;
                this.style.background = '#FF9800';
                this.textContent = 'ğŸ’°';
                break;
            case 'bomb':
                scoreChange = -50;
                this.style.background = '#dc3545';
                this.textContent = 'ğŸ’¥';
                showMessage('ğŸ’£ Ø¨Ù…Ø¨ Ù…Ù†ÙØ¬Ø± Ø´Ø¯! ÛµÛ° Ø§Ù…ØªÛŒØ§Ø² Ú©Ù… Ø´Ø¯', 'error');
                break;
            case 'time':
                timeChange = 5;
                gameTime += 5;
                this.style.background = '#2196F3';
                this.textContent = 'â•';
                showMessage('â±ï¸ Ûµ Ø«Ø§Ù†ÛŒÙ‡ Ø²Ù…Ø§Ù† Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯', 'info');
                break;
        }
        
        // Ø§Ø¹Ù…Ø§Ù„ Ù¾Ø§ÙˆØ±Ø¢Ù¾
        if (type !== 'bomb' && powerUps.doublePoints > 0) {
            scoreChange *= 2;
        }
        
        gameScore += scoreChange;
        
        // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ú©Ù„ÛŒÚ©
        this.style.transform = 'scale(1.3)';
        
        setTimeout(() => {
            if (this.parentNode) {
                this.parentNode.removeChild(this);
                activeTargets = activeTargets.filter(t => t !== this);
            }
        }, 300);
        
        updateGameDisplay();
        
        // Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯Ù†
        if (gameScore >= 2000) {
            winGame();
        }
    };
    
    // Ø­Ø°Ù Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ø² Û³-Ûµ Ø«Ø§Ù†ÛŒÙ‡
    const lifeTime = 3000 + Math.random() * 2000;
    setTimeout(() => {
        if (target.parentNode && gameActive) {
            target.parentNode.removeChild(target);
            activeTargets = activeTargets.filter(t => t !== target);
        }
    }, lifeTime);
    
    gameArea.appendChild(target);
    activeTargets.push(target);
}

function usePowerUp(type) {
    if (!gameActive || powerUps[type] <= 0) return;
    
    switch(type) {
        case 'doublePoints':
            powerUps.doublePoints--;
            document.getElementById('doubleBtn').textContent =
